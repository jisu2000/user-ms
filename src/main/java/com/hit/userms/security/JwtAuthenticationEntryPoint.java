package com.hit.userms.security;import java.io.IOException;import java.io.PrintWriter;import java.util.HashMap;import java.util.Map;import com.fasterxml.jackson.databind.ObjectMapper;import org.springframework.security.core.AuthenticationException;import org.springframework.security.web.AuthenticationEntryPoint;import org.springframework.stereotype.Component;import jakarta.servlet.ServletException;import jakarta.servlet.http.HttpServletRequest;import jakarta.servlet.http.HttpServletResponse;@Componentpublic class JwtAuthenticationEntryPoint implements AuthenticationEntryPoint{    @Override    public void commence(HttpServletRequest request, HttpServletResponse response,                         AuthenticationException authException) throws IOException, ServletException {        Map<String, String> errorResponse = new HashMap<>();        if (authException != null) {            errorResponse.put("message", "Access Denied!! " + authException.getMessage());        } else {            errorResponse.put("message", "Access Denied!!");        }        // Convert the Map to a JSON string        ObjectMapper objectMapper = new ObjectMapper();        String jsonResponse = objectMapper.writeValueAsString(errorResponse);        // Set the response content type and status        response.setContentType("application/json");        response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);        // Write the JSON response to the response's output stream        response.getWriter().write(jsonResponse);        response.getWriter().flush();    }}